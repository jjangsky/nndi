<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nndi.admin.summing.SummingMapper">

  <!-- PostCategoryDTO resultMap 생성 -->
  <resultMap type="com.nndi.model.commondto.PostCategoryDTO" id="postCategoryMap">
  	<id property="cateNum" column="CATE_NUM"/>
  	<result property="cateKind" column="CATE_KIND"/>
  </resultMap>
  
  <!-- NoticeDTO resultMap 생성 -->
  <resultMap type="com.nndi.model.commondto.NoticeDTO" id="NoticeMap">
  	<id property="num" column="NUM"/>
  	<result property="managerId" column="MANAGER_ID"/>
  	<result property="cateNum" column="CATE_NUM"/>
  	<result property="postDate" column="POST_DATE"/>
  	<result property="title" column="TITLE"/>
  	<result property="content" column="CONTENT"/>
  	<result property="hits" column="HITS"/>
  	<result property="uploadFileKey" column="UPLOAD_FILE_KEY"/>
  </resultMap>
  
  <!-- FAQDTO reaultMap 생성 -->
  <resultMap type="com.nndi.model.commondto.FAQDTO" id="FAQMap">
  	<id property="num" column="NUM"/>
  	<result property="cateNum" column="CATE_NUM"/>
  	<result property="managerId" column="MANAGER_ID"/>
  	<result property="title" column="TITLE"/>
  	<result property="content" column="CONTENT"/>
  	<result property="hits" column="HITS"/>
  </resultMap>
  
  <!-- QnaDTO reaultMap 생성 -->
  <resultMap type="com.nndi.model.commondto.QnaDTO" id="QNAMap">
  	<id property="num" column="NUM"/>
  	<result property="cateNum" column="CATE_NUM"/>
  	<result property="memId" column="MEM_ID"/>
  	<result property="managerId" column="MANAGER_ID"/>
  	<result property="postDate" column="POST_DATE"/>
  	<result property="title" column="TITLE"/>
  	<result property="content" column="CONTENT"/>
  	<result property="answerYn" column="ANSWER_YN"/>
  	<result property="answerContent" column="ANSWER_CONTENT"/>
  	<result property="displayYn" column="DISPLAY_YN"/>
  	<result property="hits" column="HITS"/>
  </resultMap>

  <!-- ComplainDTO reaultMap 생성 -->
  <resultMap type="com.nndi.model.commondto.ComplainDTO" id="complainMap">
  	<id property="num" column="NUM"/>
  	<result property="cateNum" column="CATE_NUM"/>
  	<result property="memId" column="MEM_ID"/>
  	<result property="managerId" column="MANAGER_ID"/>
  	<result property="postDate" column="POST_DATE"/>
  	<result property="title" column="TITLE"/>
  	<result property="content" column="CONTENT"/>
  	<result property="answerYn" column="ANSWER_YN"/>
  	<result property="answerContent" column="ANSWER_CONTENT"/>
  	<result property="displayYn" column="DISPLAY_YN"/>
  	<result property="hits" column="HITS"/>
  </resultMap>
  
  <!-- FAQAndCategoryDTO resultMap 생성 -->
  <resultMap type="com.nndi.model.joindto.admin.board.FAQAndCategoryDTO" id="faqAndCateMap">
  	<id property="num" column="NUM"/>
  	<result property="cateNum" column="CATE_NUM"/>
  	<result property="managerId" column="MANAGER_ID"/>
  	<result property="title" column="TITLE"/>
  	<result property="content" column="CONTENT"/>
  	<result property="hits" column="HITS"/>
  	<association property="category" resultMap="postCategoryMap"/>
  </resultMap>
  
  <!-- NoticeAndPostCategoryDTO resultMap 생성 -->
  <resultMap type="com.nndi.model.joindto.admin.board.NoticeAndCategoryDTO" id="noticeAndCateMap">
  	<id property="num" column="NUM"/>
  	<result property="managerId" column="MANAGER_ID"/>
  	<result property="cateNum" column="CATE_NUM"/>
  	<result property="postDate" column="POST_DATE"/>
  	<result property="title" column="TITLE"/>
  	<result property="content" column="CONTENT"/>
  	<result property="hits" column="HITS"/>
  	<result property="uploadFileKey" column="UPLOAD_FILE_KEY"/>
  	<association property="category" resultMap="postCategoryMap"/>
  </resultMap>
  
  <!-- MemberAlive ResultMap, typeAlias = AliveDTO -->
	<resultMap type="AliveDTO" id="memberAliveResultMap">
		<id property="id" column="ID"/>
		<result property="idQueNum" column="ID_QUE_NUM"/>
		<result property="phone1" column="PHONE1"/>
		<result property="phone2" column="PHONE2"/>
		<result property="phone3" column="PHONE3"/>
		<result property="email1" column="EMAIL1"/>
		<result property="email2" column="EMAIL2"/>
		<result property="address1" column="ADDRESS1"/>
		<result property="address2" column="ADDRESS2"/>
		<result property="address3" column="ADDRESS3"/>
		<result property="pwd" column="PWD"/>
		<result property="name" column="NAME"/>
		<result property="birth" column="BIRTH"/>
		<result property="idAnswer" column="ID_ANSWER"/>
		<result property="gender" column="GENDER"/>
		<result property="lastLogin" column="LAST_LOGIN"/>
		<result property="userStatus" column="USER_STATUS"/>
		<result property="outDate" column="OUT_DATE"/>
		<result property="enrollDate" column="ENROLL_DATE"/>
	</resultMap>
	
	<!-- MemberDead ResultMap, typeAlias = DeadDTO -->
	<resultMap type="DeadDTO" id="DeadMemberResultMap">
		<id property="no" column="NO"/>
		<result property="phone1" column="PHONE1"/>
		<result property="phone2" column="PHONE2"/>
		<result property="phone3" column="PHONE3"/>
		<result property="email1" column="EMAIL1"/>
		<result property="email2" column="EMAIL2"/>
		<result property="address1" column="ADDRESS1"/>
		<result property="address2" column="ADDRESS2"/>
		<result property="address3" column="ADDRESS3"/>
		<result property="id" column="ID"/>
		<result property="pwd" column="PWD"/>
		<result property="birth" column="BIRTH"/>
		<result property="name" column="NAME"/>
		<result property="gender" column="GENDER"/>
	</resultMap>
  
  <!-- 민원 전체 게시글 조회 -->
  <select id="selectTotalComplain" resultType="_int">
  	SELECT 
  	       COUNT(A.NUM)
  	  FROM TBL_POST_COMPLAIN A
  </select>
  
  <!-- 민원 답변 게시글 조회 -->
  <select id="selectComplainRECnt" resultType="_int">
  	SELECT 
  	       COUNT(A.ANSWER_YN)
  	  FROM TBL_POST_COMPLAIN A
  	 WHERE A.ANSWER_YN ='Y'
  </select>
  
  <!-- 민원 미답변 게시글 조회 -->
  <select id="selectComplainNotRECnt" resultType="_int">
  	SELECT 
  	       COUNT(A.ANSWER_YN)
  	  FROM TBL_POST_COMPLAIN A
  	 WHERE A.ANSWER_YN ='N'
  </select>
  
  <!-- 문의 전체 게시글 조회 -->
  <select id="selectQnaTotalcnt" resultType="_int">
  	SELECT 
  	       COUNT(A.NUM)
  	  FROM TBL_POST_QUESTION A
  </select>
  
  <!-- 문의 답변 게시글 조회 -->
  <select id="selectQnaRECnt" resultType="_int">
  	SELECT 
  	       COUNT(A.ANSWER_YN)
  	  FROM TBL_POST_QUESTION A
  	 WHERE A.ANSWER_YN ='Y'
  </select>
  
  <!-- 문의 미답변 게시글 조회 -->
  <select id="selectQnaNotRECnt" resultType="_int">
  	SELECT 
  	       COUNT(A.ANSWER_YN)
  	  FROM TBL_POST_QUESTION A
  	 WHERE A.ANSWER_YN ='N'
  </select>
  
  <!-- 자주묻는 질문 조회수 순위 -->
  <select id="selectFaqHitTops" resultMap="faqAndCateMap">
  	SELECT
  	       ROWNUM
  	     , C.NUM
  	     , C.TITLE
  	     , C.CATE_KIND
  	     , C.HITS
  	  FROM (SELECT
  	               A.NUM
  	             , A.TITLE
  	             , B.CATE_KIND
  	             , A.HITS
  	          FROM TBL_POST_FAQ A
  	          LEFT OUTER JOIN TBL_POST_CATEGORY B ON (A.CATE_NUM = B.CATE_NUM)
  	          ORDER BY A.HITS DESC) C
  	 <![CDATA[
  	 WHERE ROWNUM < 6
  	 ]]>
  </select>
  
  <!-- 공지사항 조회수 순위 -->
  <select id="selectNoticeHitTops" resultMap="noticeAndCateMap">
  	SELECT
  	       ROWNUM
  	     , C.NUM
  	     , C.TITLE
  	     , C.CATE_KIND
  	     , C.HITS
  	  FROM (SELECT
  	               A.NUM
   	             , A.TITLE
  	             , B.CATE_KIND
  	             , A.HITS
  	          FROM TBL_POST_NOTICE A
  	          LEFT OUTER JOIN TBL_POST_CATEGORY B ON (A.CATE_NUM = B.CATE_NUM)
  	          ORDER BY A.HITS DESC) C
  	 <![CDATA[
  	 WHERE ROWNUM < 6
  	 ]]>
  </select>
  
  <!-- 현재 활동 회원 수 조회 -->
  <select id="aliveMembercnt" resultType="_int">
  	SELECT 
  	       COUNT(A.ID)
  	  FROM TBL_MEMBER_ALIVE A
  	 WHERE A.USER_STATUS = 'A'
  </select>
  
  <!-- 휴면 회원 수 조회 -->
  <select id="restMemberCnt" resultType="_int">
  	SELECT 
  	       COUNT(A.ID)
  	  FROM TBL_MEMBER_ALIVE A
  	 WHERE A.USER_STATUS = 'R'
  </select>
  
  <!-- 휴면, 활동 회원 전체 조회 -->
  <select id="allMemberCnt" resultType="_int">
  	SELECT 
  	       COUNT(A.ID)
  	  FROM TBL_MEMBER_ALIVE A
  	 WHERE A.USER_STATUS IN ('A','R')
  </select>
  
  <!--  탈퇴 회원 통계 -->
  <select id="deadMemberSumming" resultType="_int">
  	SELECT 
  	       COUNT(A.ID)
  	  FROM TBL_MEMBER_DEAD A
  </select>
  
  <!-- 탈퇴 회원 통계 -->
  <select id="newMemberSum" parameterType="map" resultType="_int">
  	SELECT 
  	       COUNT(A.ID)
  	  FROM TBL_MEMBER_ALIVE A
  	 WHERE A.ENROLL_DATE BETWEEN #{ start } AND #{ end }
  </select>
</mapper>
